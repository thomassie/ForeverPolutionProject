~ lat,
radius = ~ case_when(
input$category == "Known contamination" ~ (sqrt(dd_map()$pfas_sum) / max(sqrt(dd_map()$pfas_sum), na.rm = TRUE) * 10 + 3),
input$category == "Known contamination PFAS user" ~ 5,
input$category == "Presumptive contamination" ~ 4
),
stroke = TRUE,
# color = "#666666",
color = ~ case_when(
input$category == "Known contamination" ~ pal(pfas_sum), #"#CE3818",
input$category == "Known contamination PFAS user" ~ "#1CC5DC",
input$category == "Presumptive contamination" ~ "#EB455F"
),
weight = 2,
fill = TRUE,
fillColor = ~ case_when(
input$category == "Known contamination" ~ pal(pfas_sum), #"#CE3818",
input$category == "Known contamination PFAS user" ~ "#1CC5DC",
input$category == "Presumptive contamination" ~ "#EB455F"
), #dd_map()$category, #"#CE3818", #~pal(pfas_sum),
# fillOpacity = 0.6,
fillOpacity = ~ case_when(
input$category == "Known contamination" ~ 0.7,
input$category == "Known contamination PFAS user" ~ 0.9,
input$category == "Presumptive contamination" ~ 0.7
),
popup = paste(
"<strong>", dd_map()$name, "</strong><br><br>",
"<strong>PFAS sum:   ", format(
round(dd_map()$pfas_sum, 1),
trim = TRUE,
big.mark = "'",
na.encode = TRUE,
scientific = FALSE
), "</strong><br>ng/L (water) or ng/kg (soil)<br><br>",
"City:   ", dd_map()$city, "<br>",
"Country:   ", dd_map()$country, "<br>",
"Sector:   ", dd_map()$sector, "<br>",
"Type:   ", dd_map()$type, "<br>",
"Year:   ", dd_map()$year, "<br><br>",
"Source type:   ", dd_map()$source_type, "<br>",
"Source text:   ", dd_map()$source_text, "<br>",
"<a href = \"", dd_map()$source_url, "\"> Source URL </a><br><br>",
"<a href = \"", "https://foreverpollution.eu/", "\"> foreverpollution.eu </a>"
# '<a href = "https://rstudio.github.io/leaflet/"> R </a>'
)
# label = labels_map
# clusterOptions = markerClusterOptions()
)
# ------------------ plot: bar ------------------
# output$plot_bar_top <- renderPlot(
#
#   ggplot(
#     data = dd_map() %>%
#       arrange(pfas_sum) %>%
#       slice_head(n = 10)
#   ) +
#     geom_bar(
#       x = paste0(name, " (", city, ")"),
#       y = pfas_sum
#     ) +
#     coord_flip() +
#     theme_fivethirtyeight()
#
# )
})
}
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
name = fct_reorder(name, pfas_sum, desc = TRUE)
)
) +
geom_col(
aes(
x = paste0(name, "\n(", city, ", ", country, ")"),
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
name = fct_reorder(name, pfas_sum, .desc = TRUE)
)
) +
geom_col(
aes(
x = paste0(name, "\n(", city, ", ", country, ")"),
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ")"),
name = fct_reorder(description, pfas_sum, .desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ")"),
name = fct_reorder(description, pfas_sum, .desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ")"),
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ")"),
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ")")
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ")")
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ")")
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
View(data)
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ", ", year, ")")
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ", ", year, ")")
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
View(data)
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ", ", year, ")")
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
) %>%
arrange(
description
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n(", city, ", ", country, ", ", year, ")")
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
) %>%
arrange(
description
)
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat)
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
) %>%
arrange(
description
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
slice_head(n = 10) %>%
mutate(
description = paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat)
) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
mutate(
description = paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat)
) %>%
slice_head(n = 10) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
mutate(
description = paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat)
) %>%
slice_head(n = 10) %>%
mutate(
name = fct_reorder(
.f = name,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = name,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
mutate(
description = paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat)
) %>%
slice_head(n = 20) %>%
mutate(
name = fct_reorder(
.f = name,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = name,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
levels(data$description)
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
mutate(
description = as.factor(paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat))
) %>%
slice_head(n = 10) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
data = dd %>%
arrange(desc(pfas_sum)) %>%
mutate(
description = as.factor(paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat))
) %>%
slice_head(n = 10) %>%
mutate(
name = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
data$description %>% levels()
data = dd %>%
arrange(desc(pfas_sum)) %>%
mutate(
description = as.factor(paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat))
) %>%
slice_head(n = 10) %>%
mutate(
description = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
levels(data$description)
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
mutate(
description = as.factor(paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat))
) %>%
slice_head(n = 10) %>%
mutate(
description = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = TRUE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
ggplot(
data = dd %>%
arrange(desc(pfas_sum)) %>%
mutate(
description = as.factor(paste0(name, "\n", city, ", ", country, ", ", year, "\nlongitude: ", lon, ", latitude: ", lat))
) %>%
slice_head(n = 10) %>%
mutate(
description = fct_reorder(
.f = description,
.x = pfas_sum,
.desc = FALSE)
)
) +
geom_col(
aes(
x = description,
y = pfas_sum
)
) +
coord_flip() +
theme_fivethirtyeight()
runApp('Library/Mobile Documents/com~apple~CloudDocs/Data visualisation/RShiny/Forever Polution Project/Forever_Polution_Project')
